# POCSAG 寻呼机功能使用指南

## 概述

本固件（v0.3.6-pocsag-send）集成了 POCSAG 寻呼机信息发送功能。你可以在对讲机上编写短消息，然后发送给指定的寻呼地址。

---

## 功能特性

- **支持 POCSAG 编码**：遵循 POCSAG 标准的寻呼信息编码
- **本地编码**：所有编码在对讲机内部完成，无需外部工具
- **7-bit ASCII 消息**：支持最多 ~40 个字符的 ASCII 字母、数字和符号
- **地址范围**：支持 0 ~ 2,097,151（3 个八位字节的地址空间）
- **RF 发射**：通过对讲机的 TX 电路以 1200 baud FSK 发送编码后的 POCSAG 音频

---

## 快速开始

### 进入 Messenger 菜单

1. 在对讲机主屏幕上，按 **Menu** 键进入菜单
2. 找到 **"Messenger"** 或 **"MSG"** 选项并按 **Menu** 或 **OK** 进入
3. 你应该看到屏幕分成两部分：
   - **上部**：接收区（RX），显示最近收到的消息
   - **下部**：发送区（TX），显示你正在编辑的消息

### 编写消息

在 Messenger 界面中，你可以输入要发送的信息（仅针对 POCSAG）：

1. **按数字键或文字键** 输入你的消息内容（例如 `0123` 或 `HELLO`）
   - 屏幕下部会显示你输入的文字，光标以 `_` 表示
   - 可以按 **Del/Backspace** 删除最后一个字符
   - 可以按 **Up/Down** 切换输入模式（数字、大写字母、小写字母）

2. 当完成消息编辑后，按 **MENU 键**（第一次）
   - 屏幕会弹出提示："**Enter pager addr\nthen press MENU**"
   - 这表示系统已进入"地址输入模式"

### 输入寻呼地址

1. 在地址输入模式下，**按数字键** 输入要发送到的寻呼地址（仅数字）
   - 例如：按 `1` `2` `3` `4` `5` `6` 输入地址 **123456**
   - 屏幕右侧会显示 "**Addr:123456**"（不能删除，只能新建一次，如需修改请重新按 MENU 开始）

2. **再按 MENU 键**（第二次）
   - 系统将发送 POCSAG 信息到该地址
   - 屏幕会弹出 "**POCSAG SENT**" 确认消息
   - 对讲机会通过 TX 电路发出编码后的 POCSAG 音频（约 10~15 秒）

3. 发送完成后，系统自动回到消息编辑界面

---

## 详细操作步骤示例

### 场景：发送"HELLO"到寻呼地址 123456

**步骤 1**：进入 Messenger
```
主屏幕 → 按 Menu → 选择"Messenger" → 按 Menu 或 OK
```

**步骤 2**：编写消息"HELLO"
```
在 TX 区输入：按对应的字母键或数字键输入 "HELLO"
屏幕显示：  _
          HELLO_
```

**步骤 3**：切换到地址输入模式
```
按 MENU 键（第一次）
屏幕弹出："Enter pager addr\nthen press MENU"
```

**步骤 4**：输入地址
```
按数字键：1 2 3 4 5 6
屏幕右侧显示：Addr:123456
```

**步骤 5**：发送 POCSAG
```
按 MENU 键（第二次）
屏幕显示："POCSAG SENT"
对讲机开始 TX（绿灯亮），发送编码音频（约 10~15 秒）
TX 停止后，系统回到消息编辑界面
```

---

## 按键速查表

| 按键 | 功能 |
|------|------|
| **0-9** | 输入数字或切换到数字模式 |
| **A-Z** | 输入字母（长按或循环按可得大小写） |
| **Up/Down** | 切换输入模式（数字 ↔ 大写字母 ↔ 小写字母） |
| **Del/Backspace** | 删除上一个字符（消息编辑模式下） |
| **MENU** | <ul><li>第一次：进入地址输入模式</li><li>第二次：发送 POCSAG 信息</li></ul> |
| **PTT/TX** | 发送普通消息（不是 POCSAG，使用普通 Messenger 功能） |
| **Exit/Back** | 退出 Messenger，返回主屏幕 |

---

## 常见问题 (FAQ)

### Q1：我按了 MENU 但没有任何反应？
**A**：
- 确保你在 Messenger 界面（而不是主菜单）
- 确保消息框不为空（即至少输入了一个字符）
- 再试一次按 MENU 键

### Q2：输入地址后如何删除或修改？
**A**：
- 当前版本不支持删除已输入的地址
- 如需修改，请按 MENU 键退出地址模式（屏幕会显示"POCSAG SENT"或返回消息界面）
- 然后再按 MENU 键重新开始输入新的地址

### Q3：消息太长会怎样？
**A**：
- POCSAG 对消息长度有限制（通常 ~40 字符）
- 如果消息过长，编码器会自动截断或分割
- 建议保持消息在 20-30 个字符以内以确保可靠传输

### Q4：地址可以填 0 吗？
**A**：
- 技术上可以（范围是 0 ~ 2,097,151）
- 但地址 0 可能是保留地址，建议使用 > 0 的值

### Q5：如何验证 POCSAG 是否正确发送？
**A**：
- 观察屏幕提示"POCSAG SENT"
- 观察 TX 指示灯是否亮起（通常红灯或绿灯表示发射中）
- 如有接收端，可用 multimon-ng 或其他 POCSAG 解码工具验证接收到的信号

### Q6：为什么我看不到"Addr:XXX"的显示？
**A**：
- 显示可能太小或位置不明显（屏幕右侧上方）
- 尝试在昏暗环境中查看，对比度可能会更清楚
- 或者尝试下一个版本的改进 UI（我们会加大提示字体）

---

## 技术细节

### POCSAG 信息格式

POCSAG 信息按以下格式编码：
```
[同步码] [地址码] [消息码] [CRC]
```

- **同步码**：标准 POCSAG 同步模式
- **地址码**：你输入的 6 位寻呼地址（转换为 POCSAG 格式）
- **消息码**：你的文本信息（7-bit ASCII，可达 ~40 字符）
- **CRC**：错误校验码（BCH(63, 51) 编码）

### 无线参数

- **调制**：1200 baud FSK（Frequency Shift Keying）
- **发射时长**：约 10~15 秒（取决于消息长度）
- **频率**：使用对讲机当前的 TX 频率

---

## 故障排除

### 症状：按 MENU 键后弹出错误或系统重启

**可能原因**：
1. 固件 bug（罕见）
2. 消息包含不支持的字符

**解决方案**：
- 尝试用更简单的消息重新操作（仅数字或英文字母）
- 如果问题持续，请报告给开发者

### 症状：POCSAG SENT 后，TX 灯不亮或没有声音

**可能原因**：
1. TX 路由没有配置（对讲机可能被设为 RX only）
2. 频率不对或被屏蔽

**解决方案**：
- 检查对讲机的频率设置
- 确保 TX 功能启用（进入无线设置菜单）
- 尝试用 PTT 键进行普通对话测试，确认 TX 正常

---

## 反馈与改进

如果你：
- 想要更直观的 UI（比如专用的 POCSAG 菜单）
- 发现 bug 或操作困难
- 想要添加其他功能

请联系开发者或在 GitHub issue 中提交反馈。

---

## 版本信息

- **固件版本**：v0.3.6-pocsag-send
- **POCSAG 功能**：已启用（`ENABLE_POCSAG_SEND=1`）
- **AIRCOPY 功能**：已禁用（`ENABLE_AIRCOPY=0`）以节省 FLASH 空间
- **编译日期**：2025-12-02（请见 Release 页面）

---

**祝你使用愉快！**
